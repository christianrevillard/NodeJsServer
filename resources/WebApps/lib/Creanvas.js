var f=f||{};f.a=f.a||{};window.CreJs=f;f.Creanvas=f.a;(function(){var a=f.p=f.p||{};a.q=function(e,c,d){var h=this;this.v=e;this.w=c;this.R=d||0;this.eb=function(a,d,b,e){a.lineWidth=5;a.strokeStyle=e;a.beginPath();a.moveTo(d,b);a.lineTo(d+100*h.v,b+100*h.w);a.stroke();a.lineWidth=1;a.strokeStyle="#000"};this.va=function(d){return{J:a.ja(h,d.J),s:a.ja(h,d.s),Ca:a.ja(h,d.Ca)}}};Object.defineProperty(a.q.prototype,"x",{get:function(){return this.v},set:function(a){this.v=a}});Object.defineProperty(a.q.prototype,"y",{get:function(){return this.w},set:function(a){this.w=
a}});Object.defineProperty(a.q.prototype,"z",{get:function(){return this.R},set:function(a){this.R=a}});a.Ra=function(e,c,d,h){e=d-e;c=h-c;h=Math.sqrt(e*e+c*c);return{J:new a.q(e/h,c/h,0),s:new a.q(-c/h,e/h,0),Ca:new a.q(0,0,0)}};a.gb=function(a,c,d,h,k){a.lineWidth=5;a.strokeStyle=k;a.beginPath();a.moveTo(c,d);a.lineTo(c+100*h.J.v,d+100*h.J.w);a.moveTo(c,d);a.lineTo(c+50*h.s.v,d+50*h.s.w);a.stroke();a.lineWidth=1;a.strokeStyle="#000"};a.fb=function(a,c,d,h,k,g,b){a.lineWidth=5;a.strokeStyle=b;a.beginPath();
a.moveTo(c,d);a.lineTo(c+100*k*h.J.v,d+100*k*h.J.w);a.lineTo(c+100*k*h.J.v+100*g*h.s.v,d+100*k*h.J.w+100*g*h.s.w);a.stroke();a.lineWidth=1;a.strokeStyle="#000"};a.ja=function(a,c){return a.v*c.v+a.w*c.w};a.ca=function(e,c){return new a.q(e.w*c.R-e.R*c.w,e.R*c.v-e.v*c.R,e.v*c.w-e.w*c.v)};f.Core=f.p;f.p.Vector=f.p.q})();f.a.Da=function(a){function e(){return a.elements.filter(function(a){return a.Xa})}function c(a,d,g){var b,m,e,c,r,l;b=g.cb;c=new f.p.q(g.x-a.g,g.y-a.h);r=f.p.ca(c,b.s).z;l=new f.p.q(g.x-d.g,g.y-d.h);g=f.p.ca(l,b.s).z;var q=f.p.ca(c,b.s),s=f.p.ca(l,b.s);m=new f.p.q(a.e.x,a.e.y);e=new f.p.q(d.e.x,d.e.y);a.t&&(m.x+=c.x*a.t.x,m.y+=c.y*a.t.y);d.t&&(e.x+=l.x*d.t.x,e.y+=l.y*d.t.y);c=a.sa?Infinity:a.U;l=d.sa?Infinity:d.U;var t=a.fixed?Infinity:a.wa(),u=d.fixed?Infinity:d.wa();m=a.oa*d.oa*2*(e.va(b).s-m.va(b).s+
d.u*s.z-a.u*q.z)/(1/l+1/c+s.z*s.z/u+q.z*q.z/t);a.e.x+=m/c*b.s.x;a.e.y+=m/c*b.s.y;d.e.x-=m/l*b.s.x;d.e.y-=m/l*b.s.y;a.u+=m*r/t;d.u-=m*g/u}function d(a,d){var g,b,e,c,n,r,l;c=a.ua();n=d.ua();g=Math.max(c.D,n.D)-1;b=Math.min(c.ba,n.ba)+1;e=Math.max(c.A,n.A)-1;c=Math.min(c.V,n.V)+1;if(!(0>=b-g||0>=c-e)){g=a.j.getImageData(0,0,a.i,a.o);a.j.scale(1/(a.f||1),1/(a.m||1));a.j.rotate(-(a.k||0));a.j.translate(d.g*a.b.c-a.g*a.b.c,d.h*a.b.c-a.h*a.b.c);a.j.rotate(d.k||0);a.j.scale(d.f||1,d.m||1);a.j.globalCompositeOperation=
"destination-out";a.j.drawImage(d.M.canvas,0,0,d.i,d.o,d.D,d.A,d.i,d.o);a.j.scale(1/(d.f||1),1/(d.m||1));a.j.rotate(-d.k||0);a.j.translate(-d.g*a.b.c+a.g*a.b.c,-d.h*a.b.c+a.h*a.b.c);a.j.rotate(a.k||0);a.j.scale(a.f||1,a.m||1);r=a.j.getImageData(0,0,a.i,a.o);a.j.globalCompositeOperation="source-over";a.j.putImageData(g,0,0);l=[];a.qa.forEach(function(b){90>r.data[b.y*a.i*4+4*b.x+3]&&l.push(b)});if(2>l.length)return null;var q;e=b=0;g=l.length-1;for(c=1;c<l.length;c++)for(n=c+1;n<l.length;n++){q=l[c].x-
l[n].x;var s=l[c].y-l[n].y;q=Math.sqrt(q*q+s*s);q>b&&(b=q,e=c,g=n)}b=a.Y(l[e].x+a.left,l[e].y+a.A);g=a.Y(l[g].x+a.left,l[g].y+a.A);return b.x==g.x&&b.y==g.y?null:{x:(b.x+g.x)/2,y:(b.y+g.y)/2,cb:f.p.Ra(b.x,b.y,g.x,g.y)}}}this.$a=function(a){var k=e(),g,b,m;g=a.ta();k=k.filter(function(b){var d;if(b.ha===a.ha||!(b.e.x||b.e.y||a.e.x||a.e.y||b.t||a.t||a.u||b.u))return!1;d=b.ta();return Math.sqrt((g.x-d.x)*(g.x-d.x)+(g.y-d.y)*(g.y-d.y))>a.xa()+b.xa()?!1:!0});if(0==k.length)return!0;b=null;k.forEach(function(c){b||
(b=d(a,c))&&(m=c)});if(!b)return!0;c(a,m,b);a.l.n("collision").K({element:m,Ja:b});m.l.n("collision").K({element:a,Ja:b});return!1}};f.a.Ea=function(a){var e,c,d,h,k,g,b=this;e=a.canvas;g=a.timeScale||1;this.c=a.lengthScale||e.height/a.realHeight||e.width/a.realWidth||1;a.ib?(k=Date.now(),this.getTime=function(){return(Date.now()-k)*g/1E3}):(h=0,setInterval(function(){h+=10*g/1E3},10),this.getTime=function(){return h});this.L=function(b){a.log&&a.log(b)};b.C=e.getContext("2d");b.C.setTransform(1,0,0,1,0,0);c=!0;isDrawing=!1;d=a.refreshTime||50;this.ka=function(a,d){var c=!1;b.elements.filter(function(b){return b.Ia(a)}).sort(function(a,
b){return b.P||0-a.P||0}).forEach(function(b){!c&&b.Ua(d.x,d.y)&&(b.l.n(a).K(d),c=!0)})};this.Ba=function(a,d){b.elements.forEach(function(b){b.r==d.r&&b.l.n(a).K(d)})};this.ia=function(a,d){e.addEventListener(a,function(a){setTimeout(function(){if(a.changedTouches)for(var c=0;c<a.changedTouches.length;c++){var e=a.changedTouches[c].identifier,g=b.Z(a.changedTouches[c]);g.r=e;b.ka(d,g)}else c=b.Z(a),c.r=-1,b.ka(d,c)})})};this.aa=function(a,d){e.addEventListener(a,function(a){setTimeout(function(){if(a.changedTouches)for(var c=
0;c<a.changedTouches.length;c++){var e=a.changedTouches[c].identifier,g=b.Z(a.changedTouches[c]);g.r=e;b.Ba(d,g)}else c=b.Z(a),c.r=-1,b.Ba(d,c)})})};this.l=new f.S.ea;this.ia("click","click");this.ia("mousedown","pointerDown");this.ia("touchstart","pointerDown");this.aa("mousemove","pointerMove");this.aa("touchmove","pointerMove");this.aa("mouseup","pointerUp");this.aa("touchend","pointerUp");this.ab=function(){b.l.n("deactivate").K();b.elements=[]};this.B=function(){c=!0};this.Z=function(a){var d=
e.getBoundingClientRect();b.L("ClientXY: ("+a.clientX+","+a.clientY+")");d={x:(a.clientX-d.left)*e.width/d.width/b.c,y:(a.clientY-d.top)*e.height/d.height/b.c};b.L("WebAppXY: ("+d.x+","+d.y+")");"click"==a.type&&b.L("Click on ! WebAppXY: ("+d.x+","+d.y+")");return d};b.elements=[];this.add=function(){var a=[].slice.call(arguments),d=a.filter(function(a){return a&&"name"==a[0]})[0]||["name","Unknown"],c=a.filter(function(a){return a&&"image"==a[0]})[0],e=a.filter(function(a){return a&&"position"==
a[0]})[0],d=new f.a.Ga(b,d,c,e),a=a.filter(function(a){return a&&"name"!=a[0]&&"position"!=a[0]&&"image"!=a[0]});0<a.length&&f.a.d&&d.ma.apply(d,a);b.elements.push(d);return d};b.L("Adding background");this.add(["name","background"],["image",{left:0,width:e.width/b.c,top:0,height:e.height/b.c,draw:a.drawBackground||function(d){d.fillStyle=a.backgroundStyle||"#FFF";d.fillRect(0,0,e.width/b.c,e.height/b.c)}}],["position",{z:-Infinity}]);setInterval(function(){c&&!isDrawing?(isDrawing=!0,b.elements.sort(function(a,
b){return(a.P||0)-(b.P||0)}).forEach(function(a){b.C.translate(a.g*b.c,a.h*b.c);b.C.rotate(a.k||0);b.C.scale(a.f||1,a.m||1);b.C.drawImage(a.I.canvas,0,0,a.i,a.o,a.D,a.A,a.i,a.o);b.C.scale(1/(a.f||1),1/a.m||1);b.C.rotate(-(a.k||0));b.C.translate(-a.g*b.c,-a.h*b.c)}),isDrawing=!1):b.L("No redraw")},d);this.addElement=this.add;this.redraw=this.B;this.stop=this.ab};f.a.Controller=f.a.Ea;(function(){function a(a,c){a.g=c.x||0;a.h=c.y||0;a.P=c.z||0;a.k=c.angle||0}function e(a,c){var e=c.width,g=c.height;a.top=0==c.top?0:c.top||-g/2;a.left=0==c.left?0:c.left||-e/2;a.bottom=0==c.bottom?0:c.bottom||a.top+g;a.right=0==c.right?0:c.right||a.left+e;a.H=e||a.right-a.left;a.O=g||a.bottom-a.top;a.A=Math.round(a.top*a.b.c);a.D=Math.round(a.left*a.b.c);a.V=Math.round(a.bottom*a.b.c);a.ba=Math.round(a.right*a.b.c);a.i=Math.round(a.H*a.b.c);a.o=Math.round(a.O*a.b.c);e=a.b.C.canvas.ownerDocument.createElement("canvas");
a.I=e.getContext("2d");a.f=c.scaleX||1;a.m=c.scaleY||1;c.rawImage?(a.T=c.rawImage,a.I.putImageData(a.T,0,0)):(g=c.draw,e.width=a.i,e.height=a.o,a.I.beginPath(),a.I.translate(-a.D,-a.A),a.I.scale(a.b.c,a.b.c),g.call(a,a.I),a.T=a.I.getImageData(0,0,a.i,a.o))}function c(a,c){a.X=c;a.ha=f.da.Ha()}f.a.Ga=function(d,h,k,g){var b=this;b.b=d;var m=[],p=[];c(b,h[1]);e(b,k[1]);a(b,g[1]);p.push(h);p.push(k);p.push(g);b.l=new f.S.ea;b.Ua=function(a,c){var d=b.Qa(a,c),e=d.x-b.D,d=d.y-b.A;return 0<=e&&e<=b.i&&
0<=d&&d<=b.o&&0<b.T.data[4*d*b.i+4*e+3]};b.na=function(a){var c=a?p.filter(function(b){return a.every(function(a){return a!=b[0]})}):p;return b.b.add.apply(b.b,c)};b.Ia=function(a){return"click"==a||"pointerDown"==a||b.l.Ta(a)};b.Ka=function(){b.I=null};b.b.l.n("deactivate").addListener(function(){b.Ka()});b.B=function(){b.b.B()};b.Y=function(a,c){return{x:b.g+(a*b.f*Math.cos(b.k)-c*b.m*Math.sin(b.k))/b.b.c,y:b.h+(a*b.f*Math.sin(b.k)+c*b.m*Math.cos(b.k))/b.b.c}};b.Qa=function(a,c){return{x:Math.round(((a-
b.g)*b.b.c*Math.cos(b.k)+(c-b.h)*b.b.c*Math.sin(b.k))/b.f),y:Math.round(((c-b.h)*b.b.c*Math.cos(b.k)-(a-b.g)*b.b.c*Math.sin(b.k))/b.m)}};b.ta=function(){return b.Y(b.D+b.i/2,b.A+b.o/2)};var n=[];n.push({x:b.D,y:b.A});n.push({x:b.ba,y:b.A});n.push({x:b.ba,y:b.V});n.push({x:b.D,y:b.V});b.Oa=function(){return n.map(function(a){return b.Y(a.x,a.y)})};b.Na=function(){var a=b.g+""+b.h+""+b.k+""+b.f+""+b.f;if(m.getClientCorners&&m.getClientCorners.key==a)return m.getClientCorners.value;var c=b.Oa();m.getClientCorners=
{key:a,value:c};return c};b.Pa=function(){var a=b.Na();return{top:a.reduce(function(a,b){return Math.min(a,b.y)},Infinity),bottom:a.reduce(function(a,b){return Math.max(a,b.y)},-Infinity),left:a.reduce(function(a,b){return Math.min(a,b.x)},Infinity),right:a.reduce(function(a,b){return Math.max(a,b.x)},-Infinity)}};b.ua=function(){var a=b.g+""+b.h+""+b.k+""+b.f+""+b.f;if(m.getClientRect&&m.getClientRect.key==a)return m.getClientRect.value;var c=b.Pa();m.getClientRect={key:a,value:c};return c};b.ma=
function(){var a=this,b=[].slice.apply(arguments);p=p.concat(b);b.forEach(function(b){a.ga(b[0],b[1])})};b.ga=function(a,b){var c=f.a.d[a];c&&c.G(this,b)};Object.defineProperty(b,"name",{get:function(){return this.X},set:function(a){this.X=a}});Object.defineProperty(b,"width",{get:function(){return this.H},set:function(a){this.H=a}});Object.defineProperty(b,"height",{get:function(){return this.O},set:function(a){this.O=a}});Object.defineProperty(b,"scaleX",{get:function(){return this.f},set:function(a){this.f=
a}});Object.defineProperty(b,"scaleY",{get:function(){return this.m},set:function(a){this.m=a}});Object.defineProperty(b,"x",{get:function(){return this.g},set:function(a){this.g=a}});Object.defineProperty(b,"y",{get:function(){return this.h},set:function(a){this.h=a}});Object.defineProperty(b,"z",{get:function(){return this.P},set:function(a){this.P=a}});Object.defineProperty(b,"angle",{get:function(){return this.k},set:function(a){this.k=a}});Object.defineProperty(b,"id",{get:function(){return this.ha}});
Object.defineProperty(b,"image",{get:function(){return this.T}});Object.defineProperty(b,"events",{get:function(){return this.l}});b.clone=b.na;b.applyDecorator=b.ga;b.applyDecorators=b.ma}})();f=f||{};f.a=f.a||{};f.a.d=f.a.d||[];f.a.d.clickable={G:function(a,e){var c=e.onclick;c&&(a.Za=function(d){c.call(a,d);a.B()},a.l.n("click").addListener(a.Za));var d=!1;this.r=null;var h=e.ondown,k=e.onup;a.l.n("pointerDown").addListener(function(c){a.r=c.r;d=!0;h&&(h.call(a,event),a.B())});a.l.n("pointerUp").addListener(function(c){d&&a.r==c.r&&(d=!1,k&&(k.call(a,event),a.B()))})}};f=f||{};f.a=f.a||{};f.a.d=f.a.d||[];f.a.d.customTimer={G:function(a,e){setInterval(function(){e.action.call(a)},e.time)}};f=f||{};f.a=f.a||{};f.a.d=f.a.d||[];f.a.d.droppable={G:function(a,e){var c=e.dropZone;a.Wa=!0;a.ra=c;Object.defineProperty(a,"dropZone",{get:function(){return this.ra},set:function(a){this.ra=a}})}};f=f||{};f.a=f.a||{};f.a.d=f.a.d||[];f.a.d.dropzone={G:function(a,e){var c=e.availableSpots,d=e.dropX,h=e.dropY;a.W=[];a.l.n("drop").addListener(function(e){0>=c||(c--,e.F.x=d||a.g,e.F.y=h||a.h,e.F.N=a,a.W.push(e.F),e.F.l.n("dropped").K({N:a,F:e.F}),a.l.n("droppedIn").K({N:a,F:e.F}),a.B())});a.La=function(d){d.N=null;c++;a.W.splice(a.W.indexOf(d),1);a.B()};Object.defineProperty(a,"droppedElements",{get:function(){return this.W}})}};f=f||{};f.a=f.a||{};f.a.d=f.a.d||[];f.a.d.duplicable={G:function(a,e){var c=e.isBlocked,d=e.generatorCount||Infinity,h=!1;a.l.n("pointerDown").addListener(function(e){0<=e.r&&(h=!0);if(!(h&&0>e.r||c&&c()||0>=d)){d--;var g=a.na(["duplicable"]);g.X+=" (duplicate)";g.ga("movable",{Va:c});g.Aa(e);a.B()}})}};f.a.d=f.a.d||[];f.a.elementDecorators=f.a.d;f=f||{};f.a=f.a||{};f.a.d=f.a.d||[];
f.a.d.movable={G:function(a,e){var c=!1,d=this.r=null,h=e.Va;a.Aa=function(e){c=!0;a.r=e.r;d={x:e.x,y:e.y};a.N&&(a.N.La(a),a.N=null)};a.Ya=function(e){c=!1;d=null;a.Wa&&a.b.ka("drop",{x:e.x,y:e.y,F:a})};a.l.n("pointerDown").addListener(function(c){h&&h()||a.Aa(c)});var k=!1;a.l.n("pointerMove").addListener(function(e){!c||h&&h()||(k||(k=!0),a.g+=e.x-d.x,a.h+=e.y-d.y,d={x:e.x,y:e.y},a.B())});a.l.n("pointerUp").addListener(function(e){!c||h&&h()||(a.g+=e.x-d.x,a.h+=e.y-d.y,a.Ya(e),a.r=null,k=!1,a.B())})}};f=f||{};f.a=f.a||{};f.a.d=f.a.d||[];
f.a.d.moving={type:"moving",G:function(a,e){var c,d,h,k,g,b=e.ax,m=e.ay,p=e.rotationSpeed,n,r,l;a.e=new f.p.q(e.vx||0,e.vy||0);a.Q=new f.p.q(b||0,m||0);a.u=p||0;n=a.b.getTime();setInterval(function(){r=a.b.getTime();l=r-n;if(!(.001>l)&&(n=r,a.e.x+=a.Q.x*l,a.e.y+=a.Q.y*l,0!=a.e.x||0!=a.e.y||0!=a.u||a.t&&(0!=a.t.x||0!=a.t.y))){c=a.g;d=a.h;h=a.k;k=a.f;g=a.m;a.g+=a.e.x*l;a.h+=a.e.y*l;a.k+=a.u*l;a.t&&(a.f+=a.t.x*l,a.m+=a.t.y*l);var b=!0;a.$&&a.$.forEach(function(c){b&&(c.call(a)||(b=!1))});b||(a.g=c,a.h=
d,a.k=h,a.f=k,a.m=g)}},20);Object.defineProperty(a,"speed",{get:function(){return this.e},set:function(a){this.e=a}});Object.defineProperty(a,"acceleration",{get:function(){return this.Q},set:function(a){this.Q=a}});Object.defineProperty(a,"rotationSpeed",{get:function(){return this.u},set:function(a){this.u=a}});Object.defineProperty(a,"scaleSpeed",{get:function(){return this.t},set:function(a){this.t=a}})}};f=f||{};f.a=f.a||{};f.a.d=f.a.d||[];
f.a.d.solid={G:function(a,e){a.Xa=!0;var c=[];a.U=e.mass||1;var d=e.onCollision,h=e.coefficient;a.fixed=e.fixed||!1;a.sa=a.fixed||e.fixedPoint||!1;a.b.pa=a.b.pa||new f.a.Da(a.b);a.oa=h||0===h?h:1;a.e=a.e||new f.p.q(0,0);a.Q=a.Q||new f.p.q(0,0);a.u=a.u||0;a.l.n("collision").addListener(function(b){d&&d.call(a,b)});a.$=this.$||[];a.$.push(function(){return a.b.pa.$a(a)});a.wa=function(){return a.U/12*(a.i*a.f*a.i*a.f+a.o*a.m*a.o*a.m)};a.Ma=function(){return Math.sqrt(a.H*a.H*a.f*a.f+a.O*a.O*a.m*a.m)/
2};a.xa=function(){var b=a.H+""+a.O+""+a.f+""+a.m;if(c.getRadius&&c.getRadius.key==b)return c.getRadius.bb;var d=a.Ma();c.geRadius={hb:b,bb:d};return d};var k=a.b.C.canvas,h=k.ownerDocument.createElement("canvas"),k=k.ownerDocument.createElement("canvas");h.width=k.width=a.i;h.height=k.height=a.o;a.M=k.getContext("2d");a.M.putImageData(a.T,0,0);a.M.globalCompositeOperation="source-atop";a.M.fillStyle="#000";a.M.fillRect(0,0,a.i,a.o);a.j=h.getContext("2d");a.j.globalCompositeOperation="source-over";
a.j.drawImage(a.M.canvas,0,0);h=a.j.getImageData(0,0,a.i,a.o);k=a.j.createImageData(a.i,a.o);a.qa=[];for(var g=0;g<a.i;g++)for(var b=0;b<a.o;b++)if(!(200>h.data[b*a.i*4+4*g+3])){for(var m=!1,p=-1;2>p;p++)for(var n=-1;2>n;n++)if(0>b+p||0>g+n||b+p>a.o-1||g+p>a.H-1||100>h.data[(b+p)*a.H*4+4*(g+n)+3])m=!0,n=p=2;a.j.putImageData(k,0,0);m&&(a.qa.push({x:g,y:b}),k.data[b*a.i*4+4*g]=0,k.data[b*a.i*4+4*g+1]=0,k.data[b*a.i*4+4*g+2]=0,k.data[b*a.i*4+4*g+3]=255)}a.j.putImageData(k,0,0);a.j.translate(-a.D,-a.A);
Object.defineProperty(a,"mass",{get:function(){return this.U},set:function(a){this.U=a}})}};(function(){var a=f.S=f.S||{};a.la=function(){var a=0;helpers=f.da;var c=[];this.K=function(a){var e=c.length;c.forEach(function(c){setTimeout(function(){c.handleEvent(a);e--})})};this.addListener=function(d,h){var k=a++;c.push({Sa:k,handleEvent:d,ya:h});c=c.sort(function(a,b){return(a.ya||Infinity)-(b.ya||Infinity)});return k};this.removeListener=function(a){c=c.filter(function(c){return c.Sa!=a})};this.addListener=this.addListener;this.removeListener=this.removeListener};f.Creevents=a;a.Event=a.la})();(function(){var a=f.S=f.S||{};a.ea=function(){var e={};this.Ta=function(a){return void 0!=e[a]};this.getEvent=this.n=function(c){e[c]||(e[c]=new a.la);return e[c]}};a.EventContainer=a.ea})();(function(){var a=f.da=f.da||{};a.Ha=function(){var e=Date.now().toString(16),e=a.za("x",15-e.length)+e;return("xxxxxxxx-xxxx-4xxx-y"+e.slice(0,3)+"-"+e.slice(3)).replace(/[xy]/g,function(a){var d=16*Math.random()|0;return("x"==a?d:d&3|8).toString(16)})};a.za=function(e,c){return 0>=c?"":e+a.za(e,c-1)}})();(function(){var a=f.Fa=f.Fa||{};a.fa=function(){this.L=function(a){console.log(a)}};f.Crelog=a;a.Logger=a.fa;a.fa.log=a.fa.L})();
